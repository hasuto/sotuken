var sceneEl,Maru,Batu,score=0,cnt=0,hanntei=0,cursor,isMouseDown=!1,result=[],judgement_array=[],judgement_array,correct_answer,text,score_result,Maru=document.querySelector("#Maru");function aframeMutlByte(){document.querySelectorAll("[mb-text]:empty").forEach(mb_text=>{const text=mb_text.dataset.text,text_cnt=text.length,width=1.4*text_cnt,height=1.6;let cvs=document.createElement("canvas"),ctx=cvs.getContext("2d");cvs.width=100*width,cvs.height=160,ctx.fillStyle="rgb(0, 0, 0)",ctx.font="100pt Arial",ctx.fillText(text,0,125);const base64=cvs.toDataURL("image/png");mb_text.innerHTML=`<a-image scale="${width/10} \n                            0.16 1" \n                            src="${base64}"></a-image>`})}function getCSV(){var req=new XMLHttpRequest;req.open("get","assets/"+text+".csv",!0),req.send(null),req.onload=function(){convertCSVtoArray(req.responseText)}}function convertCSVtoArray(str){for(var tmp=str.split("\n"),i=0;i<tmp.length;++i)result[i]=tmp[i].split(",")}function getCSV2(){var req=new XMLHttpRequest;req.open("get","assets/hantei.csv",!0),req.send(null),req.onload=function(){convertCSVtoArray2(req.responseText)}}function convertCSVtoArray2(str){for(var tmp=str.split("\n"),i=0;i<tmp.length;++i)judgement_array[i]=tmp[i].split(",")}function split_problem_statement(a){console.log(result[a][1]),mondai_array=result[a][1].split("\\n");var anser=[];switch(cnt){case 1:case 2:case 3:case 4:case 5:problem_statement1(mondai_array[0],a),problem_statement1_2(mondai_array[1],a),problem_statement1_3(mondai_array[2],a)}}function problem_statement1(mondai_text,a){if(console.log("okだよ"),null!=mondai_text){var mdbun_1="mdbun"+a;document.querySelectorAll("["+mdbun_1+"]:empty").forEach(mdbun_1=>{console.log(mdbun_1.dataset.text),mdbun_1.dataset.text=mondai_text;const text=mdbun_1.dataset.text,text_cnt=text.length,width=1.4*text_cnt,height=1.6;let cvs=document.createElement("canvas"),ctx=cvs.getContext("2d");cvs.width=100*width,cvs.height=160,ctx.fillStyle="rgb(0, 0, 0)",ctx.font="100pt Arial",ctx.fillText(text,0,125);const base64=cvs.toDataURL("image/png");mdbun_1.innerHTML=`<a-image whiteSpace="true" scale="${width/10} 0.16 1" src="${base64}"></a-image>`,console.log(mdbun_1)})}}function problem_statement1_2(mondai_text,a){if(console.log("okだよ"),console.log(a),null!=mondai_text){var mdbun_2="mdbun"+a+"_2";document.querySelectorAll("["+mdbun_2+"]:empty").forEach(mdbun_2=>{console.log(mdbun_2.dataset.text),mdbun_2.dataset.text=mondai_text;const text=mdbun_2.dataset.text,text_cnt=text.length,width=1.4*text_cnt,height=1.6;let cvs=document.createElement("canvas"),ctx=cvs.getContext("2d");cvs.width=100*width,cvs.height=160,ctx.fillStyle="rgb(0, 0, 0)",ctx.font="100pt Arial",ctx.fillText(text,0,125);const base64=cvs.toDataURL("image/png");mdbun_2.innerHTML=`<a-image whiteSpace="true" scale="${width/10} 0.16 1" src="${base64}"></a-image>`})}}function problem_statement1_3(mondai_text,a){if(console.log("okだよ"),console.log(a),null!=mondai_text){var mdbun_3="mdbun"+a+"_3";document.querySelectorAll("["+mdbun_3+"]:empty").forEach(mdbun_3=>{console.log(mdbun_3.dataset.text),mdbun_3.dataset.text=mondai_text;const text=mdbun_3.dataset.text,text_cnt=text.length,width=1.4*text_cnt,height=1.6;let cvs=document.createElement("canvas"),ctx=cvs.getContext("2d");cvs.width=100*width,cvs.height=160,ctx.fillStyle="rgb(0, 0, 0)",ctx.font="100pt Arial",ctx.fillText(text,0,125);const base64=cvs.toDataURL("image/png");mdbun_3.innerHTML=`<a-image whiteSpace="true" scale="${width/10} 0.16 1" src="${base64}"></a-image>`})}}function init(){sceneEl=document.querySelector("a-scene"),Maru=sceneEl.querySelector("#Maru"),Batu=sceneEl.querySelector("#Batu"),document.addEventListener("mousedown",onMouseDown),document.addEventListener("touchstart",onMouseDown),document.addEventListener("mouseup",onMouseUp),document.addEventListener("touchend",onMouseUp),document.addEventListener("mousemove",onMouseMove),document.addEventListener("touchmove",onMouseMove),aframeMutlByte(),Maru.addEventListener("click",onMouseClick1),Batu.addEventListener("click",onMouseClick2)}function render(){requestAnimationFrame(render)}function restart(){var restart=document.querySelector("#restart"),issue1=document.querySelector("#issue1"),issue2=document.querySelector("#issue2"),issue3=document.querySelector("#issue3"),issue4=document.querySelector("#issue4"),issue5=document.querySelector("#issue5"),monbun1=document.querySelector("#problem_statement1"),monbun1_2=document.querySelector("#problem_statement1_2"),monbun1_3=document.querySelector("#problem_statement1_3"),monbun2=document.querySelector("#problem_statement2"),monbun2_2=document.querySelector("#problem_statement2_2"),monbun2_3=document.querySelector("#problem_statement2_3"),monbun3=document.querySelector("#problem_statement3"),monbun3_2=document.querySelector("#problem_statement3_2"),monbun3_3=document.querySelector("#problem_statement3_3"),monbun4=document.querySelector("#problem_statement4"),monbun4_2=document.querySelector("#problem_statement4_2"),monbun4_3=document.querySelector("#problem_statement4_3"),monbun5=document.querySelector("#problem_statement5"),monbun5_2=document.querySelector("#problem_statement5_2"),monbun5_3=document.querySelector("#problem_statement5_3");score_result=document.querySelector("#score");var scoreback=document.querySelector("#score-back"),correct_answer=document.querySelector("#correct_answer"),incorrect_answer=document.querySelector("#incorrect_answer");console.log("押してる"),1==restart.getAttribute("visible")&&(score=0,cnt=0,restart.setAttribute("visible",!1),monbun1.setAttribute("visible",!1),monbun1_2.setAttribute("visible",!1),monbun1_3.setAttribute("visible",!1),issue1.setAttribute("visible",!1),monbun2.setAttribute("visible",!1),monbun2_2.setAttribute("visible",!1),monbun2_3.setAttribute("visible",!1),issue2.setAttribute("visible",!1),monbun3.setAttribute("visible",!1),monbun3_2.setAttribute("visible",!1),monbun3_3.setAttribute("visible",!1),issue3.setAttribute("visible",!1),monbun4.setAttribute("visible",!1),monbun4_2.setAttribute("visible",!1),monbun4_3.setAttribute("visible",!1),issue4.setAttribute("visible",!1),monbun5.setAttribute("visible",!1),monbun5_2.setAttribute("visible",!1),monbun5_3.setAttribute("visible",!1),issue5.setAttribute("visible",!1),scoreback.setAttribute("visible",!1),score_result.setAttribute("visible",!1),correct_answer.setAttribute("visible",!1),incorrect_answer.setAttribute("visible",!1),Maru.setAttribute("visible",!0),Batu.setAttribute("visible",!0),console.log("リスタート"),console.log(cnt,score),cnt++,issue())}function start(){var startbutton=document.querySelector("#start-button"),game_explanation_1=document.querySelector("#game-explanation_1"),game_explanation_2=document.querySelector("#game-explanation_2"),game_explanation_3=document.querySelector("#game-explanation_3");console.log(result[1][2]),1==startbutton.getAttribute("visible")&&(startbutton.setAttribute("visible",!1),game_explanation_1.setAttribute("visible",!1),game_explanation_3.setAttribute("visible",!1),Maru.setAttribute("visible",!0),Batu.setAttribute("visible",!0),cnt++,issue()),console.log(cnt)}function onMouseClick1(event){maru()}function onMouseClick2(event){batu()}function maru(){correct_answer=document.querySelector("#correct_answer");var incorrect_answer=document.querySelector("#incorrect_answer"),next=document.querySelector("#next-button");score_result=document.querySelector("#score");var scoreback=document.querySelector("#score-back"),restart=document.querySelector("#restart");if(1==Maru.getAttribute("visible"))switch(cnt){case 1:case 2:case 3:case 4:case 5:1==Batu.getAttribute("visible")&&(result[cnt][2]==judgement_array[0][0]?(incorrect_answer.setAttribute("visible",!1),correct_answer.setAttribute("visible",!0),score++):result[cnt][2]==judgement_array[1][0]&&(correct_answer.setAttribute("visible",!1),incorrect_answer.setAttribute("visible",!0)),Batu.setAttribute("visible",!1),-1!=result[cnt+1][0].indexOf("問題")?next.setAttribute("visible",!0):(score_result.setAttribute("value","score "+score),score_result.setAttribute("visible",!0),scoreback.setAttribute("visible",!0),restart.setAttribute("visible",!0)))}}function batu(){var correct_answer=document.querySelector("#correct_answer"),incorrect_answer=document.querySelector("#incorrect_answer"),next=document.querySelector("#next-button");score_result=document.querySelector("#score");var scoreback=document.querySelector("#score-back"),restart=document.querySelector("#restart");if(1==Batu.getAttribute("visible"))switch(cnt){case 1:case 2:case 3:case 4:case 5:1==Maru.getAttribute("visible")&&(result[cnt][2]==judgement_array[0][0]?(correct_answer.setAttribute("visible",!1),incorrect_answer.setAttribute("visible",!0)):result[cnt][2]==judgement_array[1][0]&&(incorrect_answer.setAttribute("visible",!1),correct_answer.setAttribute("visible",!0),score++),Maru.setAttribute("visible",!1),-1!=result[cnt+1][0].indexOf("問題")?next.setAttribute("visible",!0):(score_result.setAttribute("value","score "+score),score_result.setAttribute("visible",!0),scoreback.setAttribute("visible",!0),restart.setAttribute("visible",!0)))}}function issue(){var issue1=document.querySelector("#issue1"),issue2=document.querySelector("#issue2"),issue3=document.querySelector("#issue3"),issue4=document.querySelector("#issue4"),issue5=document.querySelector("#issue5"),monbun1=document.querySelector("#problem_statement1"),monbun1_2=document.querySelector("#problem_statement1_2"),monbun1_3=document.querySelector("#problem_statement1_3"),monbun2=document.querySelector("#problem_statement2"),monbun2_2=document.querySelector("#problem_statement2_2"),monbun2_3=document.querySelector("#problem_statement2_3"),monbun3=document.querySelector("#problem_statement3"),monbun3_2=document.querySelector("#problem_statement3_2"),monbun3_3=document.querySelector("#problem_statement3_3"),monbun4=document.querySelector("#problem_statement4"),monbun4_2=document.querySelector("#problem_statement4_2"),monbun4_3=document.querySelector("#problem_statement4_3"),monbun5=document.querySelector("#problem_statement5"),monbun5_2=document.querySelector("#problem_statement5_2"),monbun5_3=document.querySelector("#problem_statement5_3"),issueback=document.querySelector("#issue-back");switch(cnt){case 1:null!=result[cnt][0]&&(issue1.setAttribute("visible",!0),issueback.setAttribute("visible",!0),monbun1.setAttribute("visible",!0),monbun1_2.setAttribute("visible",!0),monbun1_3.setAttribute("visible",!0),console.log(cnt),split_problem_statement(cnt));break;case 2:null!=result[cnt][0]&&(issue1.setAttribute("visible",!1),issue2.setAttribute("visible",!0),monbun2.setAttribute("visible",!0),monbun2_2.setAttribute("visible",!0),monbun2_3.setAttribute("visible",!0),monbun1.setAttribute("visible",!1),monbun1_2.setAttribute("visible",!1),monbun1_3.setAttribute("visible",!1),console.log(cnt),split_problem_statement(cnt));break;case 3:null!==result[cnt][0]&&(issue2.setAttribute("visible",!1),issue3.setAttribute("visible",!0),monbun3.setAttribute("visible",!0),monbun3_2.setAttribute("visible",!0),monbun3_3.setAttribute("visible",!0),monbun2.setAttribute("visible",!1),monbun2_2.setAttribute("visible",!1),monbun2_3.setAttribute("visible",!1),split_problem_statement(cnt));break;case 4:null!==result[cnt][0]&&(issue3.setAttribute("visible",!1),issue4.setAttribute("visible",!0),monbun4.setAttribute("visible",!0),monbun4_2.setAttribute("visible",!0),monbun4_3.setAttribute("visible",!0),monbun3.setAttribute("visible",!1),monbun3_2.setAttribute("visible",!1),monbun3_3.setAttribute("visible",!1),split_problem_statement(cnt));break;case 5:null!==result[cnt][0]&&(issue4.setAttribute("visible",!1),issue5.setAttribute("visible",!0),monbun5.setAttribute("visible",!0),monbun5_2.setAttribute("visible",!0),monbun5_3.setAttribute("visible",!0),monbun4.setAttribute("visible",!1),monbun4_2.setAttribute("visible",!1),monbun4_3.setAttribute("visible",!1),split_problem_statement(cnt))}}function next(){var next=document.querySelector("#next-button"),correct_answer=document.querySelector("#correct_answer"),incorrect_answer=document.querySelector("#incorrect_answer");1==next.getAttribute("visible")&&(incorrect_answer.setAttribute("visible",!1),correct_answer.setAttribute("visible",!1),next.setAttribute("visible",!1),Maru.setAttribute("visible",!0),Batu.setAttribute("visible",!0),cnt++,issue())}function onMouseDown(event){isMouseDown=!0}function onMouseMove(event){}function onMouseUp(event){isMouseDown=!1}window.onload=function(){var camera_pc,camera_phone;(init(),render(),navigator.userAgent.indexOf("iPhone")>0&&-1==navigator.userAgent.indexOf("iPad")||navigator.userAgent.indexOf("iPod")>0||navigator.userAgent.indexOf("Android")>0)?(console.log("スマホだよーーーーmaru"),document.querySelector("#pc").setAttribute("camera","active",!1),document.querySelector("#phone").setAttribute("camera","active",!0),document.querySelector("#game-explanation_1").setAttribute("scale",{x:8,y:8,z:8}),document.querySelector("#game-explanation_3").setAttribute("scale",{x:1,y:1,z:1.5}),document.querySelector("#issue1").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#issue2").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#issue3").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#issue4").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#issue5").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement1").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement1_2").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement1_3").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement2").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement2_2").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement2_3").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement3").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement3_2").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement3_3").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement4").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement4_2").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement4_3").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement5").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement5_2").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#problem_statement5_3").setAttribute("scale",{x:7,y:7,z:7}),document.querySelector("#issue-back").setAttribute("scale",{x:2,y:3.5,z:2.3}),document.querySelector("#issue-back").setAttribute("position",{x:10,y:45,z:0}),document.querySelector("#batu-hantei").setAttribute("position",{x:27,y:1,z:0}),document.querySelector("#batu-hantei").setAttribute("scale",{x:.8,y:.8,z:.27}),document.querySelector("#maru-hantei").setAttribute("scale",{x:.8,y:.8,z:.27}),document.querySelector("#maru-hantei").setAttribute("position",{x:-7.4,y:1,z:0}),document.querySelector("#Batu").setAttribute("scale",{x:4,y:4,z:4}),document.querySelector("#Batu").setAttribute("position",{x:27,y:10,z:0}),document.querySelector("#Maru").setAttribute("scale",{x:4,y:4,z:4}),document.querySelector("#Maru").setAttribute("position",{x:-7,y:10,z:0}),document.querySelector("#start-button").setAttribute("scale",{x:3,y:3,z:3}),document.querySelector("#start-button").setAttribute("position",{x:10,y:10,z:0}),document.querySelector("#restart").setAttribute("scale",{x:3,y:3,z:3}),document.querySelector("#restart").setAttribute("position",{x:10,y:3,z:0}),document.querySelector("#next-button").setAttribute("scale",{x:3,y:3,z:3}),document.querySelector("#next-button").setAttribute("position",{x:10,y:17,z:0}),document.querySelector("#game-explanation_3").setAttribute("scale",{x:3,y:2.5,z:3.5}),document.querySelector("#issue-back").setAttribute("scale",{x:2,y:4.6,z:3}),document.querySelector("#issue-back").setAttribute("position",{x:10,y:43,z:0})):console.log("PCだよーーーーーーーmaru");var data=location.href.split("?")[1];text=data.split("=")[1],console.log(text),getCSV(),getCSV2();var background=document.querySelector("#back-ground"),a="12";background.setAttribute("src","../vr_images/"+text+".jpeg"),background.setAttribute("position",a),console.log(background.getAttribute("position")),console.log(background.getAttribute("src"))};